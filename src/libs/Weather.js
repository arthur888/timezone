import config from 'react-global-configuration';

import icon_sun_cloud from '../assets/images/weather/svg/weather-cloudy.svg';

import icon_wi_owm_200 from '../assets/weather-svg/wi-owm-200.svg';
import icon_wi_owm_201 from '../assets/weather-svg/wi-owm-201.svg';
import icon_wi_owm_202 from '../assets/weather-svg/wi-owm-202.svg';
import icon_wi_owm_210 from '../assets/weather-svg/wi-owm-210.svg';
import icon_wi_owm_211 from '../assets/weather-svg/wi-owm-211.svg';
import icon_wi_owm_212 from '../assets/weather-svg/wi-owm-212.svg';
import icon_wi_owm_221 from '../assets/weather-svg/wi-owm-221.svg';
import icon_wi_owm_230 from '../assets/weather-svg/wi-owm-230.svg';
import icon_wi_owm_231 from '../assets/weather-svg/wi-owm-231.svg';
import icon_wi_owm_232 from '../assets/weather-svg/wi-owm-232.svg';
import icon_wi_owm_300 from '../assets/weather-svg/wi-owm-300.svg';
import icon_wi_owm_301 from '../assets/weather-svg/wi-owm-301.svg';
import icon_wi_owm_302 from '../assets/weather-svg/wi-owm-302.svg';
import icon_wi_owm_310 from '../assets/weather-svg/wi-owm-310.svg';
import icon_wi_owm_311 from '../assets/weather-svg/wi-owm-311.svg';
import icon_wi_owm_312 from '../assets/weather-svg/wi-owm-312.svg';
import icon_wi_owm_313 from '../assets/weather-svg/wi-owm-313.svg';
import icon_wi_owm_314 from '../assets/weather-svg/wi-owm-314.svg';
import icon_wi_owm_321 from '../assets/weather-svg/wi-owm-321.svg';
import icon_wi_owm_500 from '../assets/weather-svg/wi-owm-500.svg';
import icon_wi_owm_501 from '../assets/weather-svg/wi-owm-501.svg';
import icon_wi_owm_502 from '../assets/weather-svg/wi-owm-502.svg';
import icon_wi_owm_503 from '../assets/weather-svg/wi-owm-503.svg';
import icon_wi_owm_504 from '../assets/weather-svg/wi-owm-504.svg';
import icon_wi_owm_511 from '../assets/weather-svg/wi-owm-511.svg';
import icon_wi_owm_520 from '../assets/weather-svg/wi-owm-520.svg';
import icon_wi_owm_521 from '../assets/weather-svg/wi-owm-521.svg';
import icon_wi_owm_522 from '../assets/weather-svg/wi-owm-522.svg';
import icon_wi_owm_531 from '../assets/weather-svg/wi-owm-531.svg';
import icon_wi_owm_600 from '../assets/weather-svg/wi-owm-600.svg';
import icon_wi_owm_601 from '../assets/weather-svg/wi-owm-601.svg';
import icon_wi_owm_602 from '../assets/weather-svg/wi-owm-602.svg';
import icon_wi_owm_611 from '../assets/weather-svg/wi-owm-611.svg';
import icon_wi_owm_612 from '../assets/weather-svg/wi-owm-612.svg';
import icon_wi_owm_615 from '../assets/weather-svg/wi-owm-615.svg';
import icon_wi_owm_616 from '../assets/weather-svg/wi-owm-616.svg';
import icon_wi_owm_620 from '../assets/weather-svg/wi-owm-620.svg';
import icon_wi_owm_621 from '../assets/weather-svg/wi-owm-621.svg';
import icon_wi_owm_622 from '../assets/weather-svg/wi-owm-622.svg';
import icon_wi_owm_701 from '../assets/weather-svg/wi-owm-701.svg';
import icon_wi_owm_711 from '../assets/weather-svg/wi-owm-711.svg';
import icon_wi_owm_721 from '../assets/weather-svg/wi-owm-721.svg';
import icon_wi_owm_731 from '../assets/weather-svg/wi-owm-731.svg';
import icon_wi_owm_741 from '../assets/weather-svg/wi-owm-741.svg';
import icon_wi_owm_761 from '../assets/weather-svg/wi-owm-761.svg';
import icon_wi_owm_762 from '../assets/weather-svg/wi-owm-762.svg';
import icon_wi_owm_771 from '../assets/weather-svg/wi-owm-771.svg';
import icon_wi_owm_781 from '../assets/weather-svg/wi-owm-781.svg';
import icon_wi_owm_800 from '../assets/weather-svg/wi-owm-800.svg';
import icon_wi_owm_801 from '../assets/weather-svg/wi-owm-801.svg';
import icon_wi_owm_802 from '../assets/weather-svg/wi-owm-802.svg';
import icon_wi_owm_803 from '../assets/weather-svg/wi-owm-803.svg';
import icon_wi_owm_804 from '../assets/weather-svg/wi-owm-804.svg';
import icon_wi_owm_900 from '../assets/weather-svg/wi-owm-900.svg';
import icon_wi_owm_901 from '../assets/weather-svg/wi-owm-901.svg';
import icon_wi_owm_902 from '../assets/weather-svg/wi-owm-902.svg';
import icon_wi_owm_903 from '../assets/weather-svg/wi-owm-903.svg';
import icon_wi_owm_904 from '../assets/weather-svg/wi-owm-904.svg';
import icon_wi_owm_905 from '../assets/weather-svg/wi-owm-905.svg';
import icon_wi_owm_906 from '../assets/weather-svg/wi-owm-906.svg';
import icon_wi_owm_957 from '../assets/weather-svg/wi-owm-957.svg';

var IconCodes = {
	'200': {code: '200', icon: icon_wi_owm_200 },
	'201': {code: '201', icon: icon_wi_owm_201 },
	'202': {code: '202', icon: icon_wi_owm_202 },
	'210': {code: '210', icon: icon_wi_owm_210 },
	'211': {code: '211', icon: icon_wi_owm_211 },
	'212': {code: '212', icon: icon_wi_owm_212 },
	'221': {code: '221', icon: icon_wi_owm_221 },
	'230': {code: '230', icon: icon_wi_owm_230 },
	'231': {code: '231', icon: icon_wi_owm_231 },
	'232': {code: '232', icon: icon_wi_owm_232 },
	'300': {code: '300', icon: icon_wi_owm_300 },
	'301': {code: '301', icon: icon_wi_owm_301 },
	'302': {code: '302', icon: icon_wi_owm_302 },
	'310': {code: '310', icon: icon_wi_owm_310 },
	'311': {code: '311', icon: icon_wi_owm_311 },
	'312': {code: '312', icon: icon_wi_owm_312 },
	'313': {code: '313', icon: icon_wi_owm_313 },
	'314': {code: '314', icon: icon_wi_owm_314 },
	'321': {code: '321', icon: icon_wi_owm_321 },
	'500': {code: '500', icon: icon_wi_owm_500 },
	'501': {code: '501', icon: icon_wi_owm_501 },
	'502': {code: '502', icon: icon_wi_owm_502 },
	'503': {code: '503', icon: icon_wi_owm_503 },
	'504': {code: '504', icon: icon_wi_owm_504 },
	'511': {code: '511', icon: icon_wi_owm_511 },
	'520': {code: '520', icon: icon_wi_owm_520 },
	'521': {code: '521', icon: icon_wi_owm_521 },
	'522': {code: '522', icon: icon_wi_owm_522 },
	'531': {code: '531', icon: icon_wi_owm_531 },
	'600': {code: '600', icon: icon_wi_owm_600 },
	'601': {code: '601', icon: icon_wi_owm_601 },
	'602': {code: '602', icon: icon_wi_owm_602 },
	'611': {code: '611', icon: icon_wi_owm_611 },
	'612': {code: '612', icon: icon_wi_owm_612 },
	'615': {code: '615', icon: icon_wi_owm_615 },
	'616': {code: '616', icon: icon_wi_owm_616 },
	'620': {code: '620', icon: icon_wi_owm_620 },
	'621': {code: '621', icon: icon_wi_owm_621 },
	'622': {code: '622', icon: icon_wi_owm_622 },
	'701': {code: '701', icon: icon_wi_owm_701 },
	'711': {code: '711', icon: icon_wi_owm_711 },
	'721': {code: '721', icon: icon_wi_owm_721 },
	'731': {code: '731', icon: icon_wi_owm_731 },
	'741': {code: '741', icon: icon_wi_owm_741 },
	'761': {code: '761', icon: icon_wi_owm_761 },
	'762': {code: '762', icon: icon_wi_owm_762 },
	'771': {code: '771', icon: icon_wi_owm_771 },
	'781': {code: '781', icon: icon_wi_owm_781 },
	'800': {code: '800', icon: icon_wi_owm_800 },
	'801': {code: '801', icon: icon_wi_owm_801 },
	'802': {code: '802', icon: icon_wi_owm_802 },
	'803': {code: '803', icon: icon_wi_owm_803 },
	'804': {code: '804', icon: icon_wi_owm_804 },
	'900': {code: '900', icon: icon_wi_owm_900 },
	'901': {code: '901', icon: icon_wi_owm_901 },
	'902': {code: '902', icon: icon_wi_owm_902 },
	'903': {code: '903', icon: icon_wi_owm_903 },
	'904': {code: '904', icon: icon_wi_owm_904 },
	'905': {code: '905', icon: icon_wi_owm_905 },
	'906': {code: '906', icon: icon_wi_owm_906 },
	'957': {code: '957', icon: icon_wi_owm_957 },
}

export default class Weather {
	get(address, unit) {
		unit = unit || 'imperal';
		return new Promise( (resolve, reject) => {
			var search_url = 'q=';
			if(typeof address === 'object') {
				search_url = 'lat=' + address.lat + '&lon=' + address.lng; 
			} else {
				search_url += encodeURIComponent(address);
			}
			fetch('http://api.openweathermap.org/data/2.5/forecast/daily?units='+ unit +'&'+ search_url +'&cnt=4&APPID='+ config.get('openweatherapi'))
				.then( (r) => r.json() )
				.then( (j) => {
					j.list.forEach( (item, i) => {
						var icon_url = IconCodes[item.weather[0].id.toString()];
						if(icon_url) {
							icon_url = icon_url.icon;
						}
						j.list[i].weather[0].icon_url = icon_url || icon_sun_cloud;
					} );
					resolve.apply(this, [j]);
				} );
		});	
	}
}